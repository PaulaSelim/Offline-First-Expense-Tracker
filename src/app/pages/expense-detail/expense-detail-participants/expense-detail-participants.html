<!-- Participants Section -->
<div class="card bg-dark border-light">
  <div class="card-header">
    <h5 class="text-white mb-0">👥 Expense Participants</h5>
  </div>
  <div class="card-body">
    @if (isLoadingParticipants()) {
      <div class="text-center py-3">
        <div class="spinner-border spinner-border-sm text-light" role="status">
          <span class="visually-hidden">Loading participants...</span>
        </div>
      </div>
    } @else if (expenseParticipants() && expenseParticipants().length > 0) {
      <div class="list-group list-group-flush">
        @for (
          participant of expenseParticipants();
          track participant.user_id || participant.id
        ) {
          <div
            class="list-group-item bg-transparent border-secondary d-flex justify-content-between align-items-center"
          >
            <div class="d-flex align-items-center">
              <div class="me-3">
                @if (participant.user_id === selectedExpense()?.payer_id) {
                  <span class="badge bg-success">💳 Payer</span>
                } @else {
                  <span class="badge bg-info">👤 Participant</span>
                }
              </div>
              <div>
                <h6 class="text-white mb-1">
                  {{
                    participant.username ||
                      participant.email ||
                      getParticipantName(participant.user_id || "")
                  }}
                </h6>
                <small class="text-secondary">
                  Owes: {{ getFormattedAmount(calculateSplitAmount()) }}
                </small>
              </div>
            </div>
            <div class="d-flex align-items-center">
              <span class="badge bg-warning text-dark">⏳ Pending</span>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="text-center py-4 text-secondary">
        <p>No participants found for this expense.</p>
      </div>
    }
  </div>
</div>
