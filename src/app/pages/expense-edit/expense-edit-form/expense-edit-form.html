<form class="form" [formGroup]="form()" (ngSubmit)="onSubmit()">
  <div class="container mt-4">
    <app-expense-title-input [form]="form()" [isInvalid]="isInvalid()" />

    <app-expense-amount-date-input [form]="form()" [isInvalid]="isInvalid()" />

    <app-expense-category-selection
      [form]="form()"
      [isInvalid]="isInvalid()"
      [categories]="categories()"
    />

    <app-expense-payer-selection
      [form]="form()"
      [isInvalid]="isInvalid()"
      [groupMembers]="groupMembers()"
    />

    <app-expense-participants-selection
      [form]="form()"
      [isInvalid]="isInvalid()"
      [groupMembers]="groupMembers()"
      [isParticipantSelected]="isParticipantSelected()"
      (participantToggle)="onParticipantToggle($event)"
      (selectAllParticipants)="onSelectAll()"
      (clearAllParticipants)="onClearAll()"
    />

    <div class="d-flex justify-content-between mb-3">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="onCancel()"
        [disabled]="isSubmitting()"
      >
        Cancel
      </button>
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="form().invalid || isSubmitting()"
      >
        @if (isSubmitting()) {
          <span class="spinner-border spinner-border-sm me-2" role="status">
            <span class="visually-hidden">Loading...</span>
          </span>
          Updating Expense...
        } @else {
          <i class="bi bi-pencil-fill me-1"></i> Edit
        }
      </button>
    </div>
  </div>
</form>
