<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card bg-dark border-light">
        <div class="card-header">
          <h3 class="text-white mb-0">Create New Expense</h3>
        </div>
        <div class="card-body">
          <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()">
            
            <!-- Title Input -->
            <div class="form-group mb-3">
              <label class="form-label text-white" for="title">Expense Title *</label>
              <input
                class="form-control"
                type="text"
                id="title"
                placeholder="Enter expense title"
                formControlName="title"
                [class.is-invalid]="isInvalid('title')"
              />
              @if (isInvalid('title')) {
                <div class="invalid-feedback">
                  <strong>Title is invalid:</strong>
                  <ul>
                    @if (expenseForm.get('title')?.errors?.['required']) {
                      <li>Title is required.</li>
                    }
                    @if (expenseForm.get('title')?.errors?.['minlength']) {
                      <li>Title must be at least 3 characters long.</li>
                    }
                    @if (expenseForm.get('title')?.errors?.['maxlength']) {
                      <li>Title cannot exceed 100 characters.</li>
                    }
                  </ul>
                </div>
              }
            </div>

            <!-- Amount and Date Row -->
            <app-expense-amount-date-row
              [form]="expenseForm"
              [isInvalid]="isInvalid.bind(this)"
            ></app-expense-amount-date-row>

            <!-- Category Selection -->
            <app-expense-category-selection
              [form]="expenseForm"
              [isInvalid]="isInvalid.bind(this)"
              [categories]="categories"
            ></app-expense-category-selection>

            <!-- Payer Selection -->
            <app-expense-payer-selection
              [form]="expenseForm"
              [isInvalid]="isInvalid.bind(this)"
              [members]="groupMembers()"
            ></app-expense-payer-selection>

            <!-- Include Payer Checkbox -->
            <app-expense-include-payer-checkbox
              [form]="expenseForm"
            ></app-expense-include-payer-checkbox>

            <!-- Participant Selection -->
            <app-expense-participant-selection
              [members]="groupMembers()"
              [isSelected]="isParticipantSelected.bind(this)"
              (selectAll)="onSelectAllParticipants()"
              (clearAll)="onClearAllParticipants()"
              (toggleParticipant)="onToggleParticipant($event)"
            ></app-expense-participant-selection>

            <!-- Form Actions -->
            <app-expense-form-actions
              [form]="expenseForm"
              [isSubmitting]="isSubmitting()"
              [submitText]="'Create Expense'"
              [loadingText]="'Creating...'"
              [submitButtonClass]="'btn btn-primary'"
              (cancel)="onCancel()"
            ></app-expense-form-actions>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>